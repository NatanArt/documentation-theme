"use strict";(function(){const p="/en.search-data.min.4f53cda18c2baa0c0354bb5f9a3ecbe5ed12ab4d8e11ba873c2f11161202b945.json",e=document.querySelector("#book-search-input input"),s=document.querySelector("#search-overlay"),n=document.querySelector("#book-search-hits"),t=document.querySelector("#book-search-results ul"),c=1/0,b=2,r=new Map;if(!e)return;e.addEventListener("focus",d),e.addEventListener("keyup",u),document.addEventListener("keypress",h),s.addEventListener("click",()=>{a()});function h(t){if(t.target.value!==void 0)return;if(e===document.activeElement)return;const n=String.fromCharCode(t.charCode);if(!g(n))return;e.focus(),t.preventDefault()}function g(t){const n=e.getAttribute("data-hotkeys")||"";return n.indexOf(t)>=0}function d(){e.removeEventListener("focus",d),e.required=!0,fetch(p).then(e=>e.json()).then(e=>{window.lunrIdx=lunr(function(){this.ref("id"),this.field("id"),this.field("content"),this.field("href"),this.metadataWhitelist=["position"];for(const t of e)r.set(t.id,t),this.add(t)})}).then(()=>e.required=!1).then(u)}function u(){const n=e.value?.trim();if(e.required)return;for(;t.firstChild;)t.removeChild(t.firstChild);if(!n||n.length<=b){a();return}function s(e){return n.split(" ").map(t=>{if(!t)return;return t.length<=4||!e?`+${t}`:`+${t}~1`}).filter(e=>!!e).join(" ")}function l(){const e=window.lunrIdx.search(s()).slice(0,c);return e.length?e:window.lunrIdx.search(s(!0)).slice(0,c)}const i=l();if(v(),!i.length){o(`Not Found`,`Sorry, we couldn't find any matches. Try searching for a different keyword`);return}i.forEach(e=>{const t=r.get(Number(e.ref));if(!t)return;const n=m(t.content,e);o(t.title,n,t.href)})}function o(e,n,s){const o=f("<li><a href><h4></h4><span></span></a></li>");s&&(o.querySelector("a").href=s),o.querySelector("h4").textContent=e,o.querySelector("span").innerHTML=n,t.appendChild(o)}function m(e,t){const s=60,{metadata:i}=t.matchData;let o=0,a=100;const r=Object.keys(i).sort();for(const n of r){const t=i[n]?.content?.position;if(!t)continue;for(const i of t){const n=i[0];o=Math.max(0,e.length-n<=s?n-s*2:n-s),a=n+i[1]+s}break}let n=e.slice(o,a);o!==0&&(n=`...${n}`);for(const e of r)n=n.replace(new RegExp(e,"gi"),"<strong>$&</strong>");return n+"..."}function f(e){const t=document.createElement("div");return t.innerHTML=e,t.firstChild}function i(e){e.classList.add("hidden")}function l(e){e.classList.remove("hidden")}function v(){if(!n.classList.contains("hidden"))return;n.scrollTop=0,l(s),l(n)}function a(){i(s),i(n)}})()